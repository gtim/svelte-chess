var c=Object.defineProperty;var m=(i,t,e)=>t in i?c(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var o=(i,t,e)=>(m(i,typeof t!="symbol"?t+"":t,e),e);import{S as l,i as f,s as d,k as p,y as u,l as v,m as g,z as k,h as a,p as h,b as _,A as M,H as $,g as w,d as U,B as y}from"../chunks/index.18b0dfda.js";import{C as B}from"../chunks/Chess.ff65046b.js";class b{constructor(t={}){o(this,"stockfish");o(this,"state",0);o(this,"moveTime");o(this,"depth");o(this,"color");o(this,"onUciOk");o(this,"onBestMove");this.moveTime=t.moveTime||2e3,this.depth=t.depth||40,this.color=t.color||"b"}init(){return new Promise(t=>{this.state=1,this.stockfish=new Worker("stockfish.js"),this.stockfish.addEventListener("message",e=>this._onUci(e)),this.onUciOk=()=>{this.state===1&&(this.state=2,this.onUciOk=void 0,t())},this.stockfish.postMessage("uci")})}_onUci({data:t}){const e=t;console.log("UCI: "+e),this.onUciOk&&e==="uciok"&&this.onUciOk(),this.onBestMove&&e.slice(0,8)==="bestmove"&&this.onBestMove(e)}getMove(t){return new Promise(e=>{if(!this.stockfish)throw new Error("Engine not initialised");this.state=3,this.stockfish.postMessage("position fen "+t),this.stockfish.postMessage(`go depth ${this.depth} movetime ${this.moveTime}`),this.onBestMove=n=>{const r=n.split(" ")[1];this.state=2,this.onBestMove=void 0,e(r)}})}getColor(){return this.color}}function x(i){let t,e,n;return e=new B({props:{orientation:"b",engine:new b({depth:20,moveTime:1500,color:"w"})}}),{c(){t=p("div"),u(e.$$.fragment),this.h()},l(s){t=v(s,"DIV",{style:!0});var r=g(t);k(e.$$.fragment,r),r.forEach(a),this.h()},h(){h(t,"max-width","512px"),h(t,"margin","0 auto")},m(s,r){_(s,t,r),M(e,t,null),n=!0},p:$,i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){U(e.$$.fragment,s),n=!1},d(s){s&&a(t),y(e)}}}class T extends l{constructor(t){super(),f(this,t,null,x,d,{})}}export{T as component};
